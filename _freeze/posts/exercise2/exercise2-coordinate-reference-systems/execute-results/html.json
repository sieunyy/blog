{
  "hash": "01f98eb1fbf170db4673eed750f14664",
  "result": {
    "markdown": "---\ntitle: 'Exercise2: Coordinate Reference Systems'\nauthor: Sieun Shim\ndate: '2023-04-29'\ncategories:\n  - code\n  - geopandas\ntoc: true\n---\n\n> Kaggle Geospatial Analysis Exercise2\n\n**This notebook is an exercise in the [Geospatial Analysis](https://www.kaggle.com/learn/geospatial-analysis) course.  You can reference the tutorial at [this link](https://www.kaggle.com/alexisbcook/coordinate-reference-systems).**\n\n---\n\n\n# Introduction\n\nYou are a bird conservation expert and want to understand migration patterns of purple martins.  In your research, you discover that these birds typically spend the summer breeding season in the eastern United States, and then migrate to South America for the winter.  But since this bird is under threat of endangerment, you'd like to take a closer look at the locations that these birds are more likely to visit.\n\n<center>\n<img src=\"https://storage.googleapis.com/kaggle-media/learn/images/qQcS0KM.png\" width=\"1000\"><br/>\n</center>\n\nThere are several [protected areas](https://www.iucn.org/theme/protected-areas/about) in South America, which operate under special regulations to ensure that species that migrate (or live) there have the best opportunity to thrive.  You'd like to know if purple martins tend to visit these areas.  To answer this question, you'll use some recently collected data that tracks the year-round location of eleven different birds.\n\nBefore you get started, run the code cell below to set everything up.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport geopandas as gpd\n\nfrom shapely.geometry import LineString\n```\n:::\n\n\n# Exercises\n\n### 1) Load the data.\n\nRun the next code cell (without changes) to load the GPS data into a pandas DataFrame `birds_df`.  \n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\n# Load the data and print the first 5 rows\nbirds_df = pd.read_csv(\"../../../spatial_analysis/data/purple_martin.csv\", parse_dates = ['timestamp'])\nprint(\"There are {} different birds in the dataset.\".format(birds_df[\"tag-local-identifier\"].nunique()))\nbirds_df.head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThere are 11 different birds in the dataset.\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>timestamp</th>\n      <th>location-long</th>\n      <th>location-lat</th>\n      <th>tag-local-identifier</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2014-08-15 05:56:00</td>\n      <td>-88.146014</td>\n      <td>17.513049</td>\n      <td>30448</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2014-09-01 05:59:00</td>\n      <td>-85.243501</td>\n      <td>13.095782</td>\n      <td>30448</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2014-10-30 23:58:00</td>\n      <td>-62.906089</td>\n      <td>-7.852436</td>\n      <td>30448</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2014-11-15 04:59:00</td>\n      <td>-61.776826</td>\n      <td>-11.723898</td>\n      <td>30448</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2014-11-30 09:59:00</td>\n      <td>-61.241538</td>\n      <td>-11.612237</td>\n      <td>30448</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThere are 11 birds in the dataset, where each bird is identified by a unique value in the \"tag-local-identifier\" column.  Each bird has several measurements, collected at different times of the year.\n\nUse the next code cell to create a GeoDataFrame `birds`.  \n- `birds` should have all of the columns from `birds_df`, along with a \"geometry\" column that contains Point objects with (longitude, latitude) locations.  \n- Set the CRS of `birds` to `{'init': 'epsg:4326'}`.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# Create the GeoDataFrame\nbirds = gpd.GeoDataFrame(birds_df, geometry = gpd.points_from_xy(birds_df['location-long'], birds_df['location-lat']))\n\n# Set the CRS to {'init': 'epsg:4326'}\nbirds.crs = {'init': 'epsg:4326'}\nbirds.head()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\sse88\\anaconda3\\lib\\site-packages\\pyproj\\crs\\crs.py:141: FutureWarning:\n\n'+init=<authority>:<code>' syntax is deprecated. '<authority>:<code>' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>timestamp</th>\n      <th>location-long</th>\n      <th>location-lat</th>\n      <th>tag-local-identifier</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2014-08-15 05:56:00</td>\n      <td>-88.146014</td>\n      <td>17.513049</td>\n      <td>30448</td>\n      <td>POINT (-88.14601 17.51305)</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2014-09-01 05:59:00</td>\n      <td>-85.243501</td>\n      <td>13.095782</td>\n      <td>30448</td>\n      <td>POINT (-85.24350 13.09578)</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2014-10-30 23:58:00</td>\n      <td>-62.906089</td>\n      <td>-7.852436</td>\n      <td>30448</td>\n      <td>POINT (-62.90609 -7.85244)</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2014-11-15 04:59:00</td>\n      <td>-61.776826</td>\n      <td>-11.723898</td>\n      <td>30448</td>\n      <td>POINT (-61.77683 -11.72390)</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2014-11-30 09:59:00</td>\n      <td>-61.241538</td>\n      <td>-11.612237</td>\n      <td>30448</td>\n      <td>POINT (-61.24154 -11.61224)</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 2) Plot the data.\n\nNext, we load in the `'naturalearth_lowres'` dataset from GeoPandas, and set `americas` to a GeoDataFrame containing the boundaries of all countries in the Americas (both North and South America).  Run the next code cell without changes.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n# Load a GeoDataFrame with country boundaries in North/South America, print the first 5 rows\nworld = gpd.read_file(gpd.datasets.get_path('naturalearth_lowres'))\namericas = world.loc[world['continent'].isin(['North America', 'South America'])]\namericas.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>pop_est</th>\n      <th>continent</th>\n      <th>name</th>\n      <th>iso_a3</th>\n      <th>gdp_md_est</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3</th>\n      <td>37589262.0</td>\n      <td>North America</td>\n      <td>Canada</td>\n      <td>CAN</td>\n      <td>1736425</td>\n      <td>MULTIPOLYGON (((-122.84000 49.00000, -122.9742...</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>328239523.0</td>\n      <td>North America</td>\n      <td>United States of America</td>\n      <td>USA</td>\n      <td>21433226</td>\n      <td>MULTIPOLYGON (((-122.84000 49.00000, -120.0000...</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>44938712.0</td>\n      <td>South America</td>\n      <td>Argentina</td>\n      <td>ARG</td>\n      <td>445445</td>\n      <td>MULTIPOLYGON (((-68.63401 -52.63637, -68.25000...</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>18952038.0</td>\n      <td>South America</td>\n      <td>Chile</td>\n      <td>CHL</td>\n      <td>282318</td>\n      <td>MULTIPOLYGON (((-68.63401 -52.63637, -68.63335...</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>11263077.0</td>\n      <td>North America</td>\n      <td>Haiti</td>\n      <td>HTI</td>\n      <td>14332</td>\n      <td>POLYGON ((-71.71236 19.71446, -71.62487 19.169...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nUse the next code cell to create a single plot that shows both: (1) the country boundaries in the `americas` GeoDataFrame, and (2) all of the points in the `birds_gdf` GeoDataFrame.  \n\nDon't worry about any special styling here; just create a preliminary plot, as a quick sanity check that all of the data was loaded properly.  In particular, you don't have to worry about color-coding the points to differentiate between birds, and you don't have to differentiate starting points from ending points.  We'll do that in the next part of the exercise.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nax = americas.plot(figsize = (8,8), color = 'whitesmoke', linestyle = ':', edgecolor = 'black')\nbirds.plot(markersize = 10, ax = ax)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n<AxesSubplot:>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](exercise2-coordinate-reference-systems_files/figure-html/cell-6-output-2.png){width=652 height=578}\n:::\n:::\n\n\n### 3) Where does each bird start and end its journey? (Part 1)\n\nNow, we're ready to look more closely at each bird's path.  Run the next code cell to create two GeoDataFrames:\n- `path_gdf` contains LineString objects that show the path of each bird.  It uses the `LineString()` method to create a LineString object from a list of Point objects.\n- `start_gdf` contains the starting points for each bird.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# GeoDataFrame showing path for each bird\npath_df = birds.groupby(\"tag-local-identifier\")['geometry'].apply(list).apply(lambda x: LineString(x)).reset_index()\npath_gdf = gpd.GeoDataFrame(path_df, geometry = path_df.geometry)\npath_gdf.crs = {'init': 'epsg:4326'}\n\n# GeoDataFrame showing starting point for each bird\nstart_df = birds.groupby(\"tag-local-identifier\")['geometry'].apply(list).apply(lambda x: x[0]).reset_index()\nstart_gdf = gpd.GeoDataFrame(start_df, geometry = start_df.geometry)\nstart_gdf.crs = {'init': 'epsg:4326'}\n\n# Show first five rows of GeoDataFrame\nstart_gdf.head()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\sse88\\anaconda3\\lib\\site-packages\\pyproj\\crs\\crs.py:141: FutureWarning:\n\n'+init=<authority>:<code>' syntax is deprecated. '<authority>:<code>' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6\n\nC:\\Users\\sse88\\anaconda3\\lib\\site-packages\\pyproj\\crs\\crs.py:141: FutureWarning:\n\n'+init=<authority>:<code>' syntax is deprecated. '<authority>:<code>' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>tag-local-identifier</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>30048</td>\n      <td>POINT (-90.12992 20.73242)</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>30054</td>\n      <td>POINT (-93.60861 46.50563)</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>30198</td>\n      <td>POINT (-80.31036 25.92545)</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>30263</td>\n      <td>POINT (-76.78146 42.99209)</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>30275</td>\n      <td>POINT (-76.78213 42.99207)</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nUse the next code cell to create a GeoDataFrame `end_gdf` containing the final location of each bird.  \n- The format should be identical to that of `start_gdf`, with two columns (\"tag-local-identifier\" and \"geometry\"), where the \"geometry\" column contains Point objects.\n- Set the CRS of `end_gdf` to `{'init': 'epsg:4326'}`.\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nend_df = birds.groupby(\"tag-local-identifier\")['geometry'].apply(list).apply(lambda x: x[-1]).reset_index()\nend_gdf = gpd.GeoDataFrame(end_df, geometry = end_df.geometry)\nend_gdf.crs = {'init': 'epsg:4326'}\nend_gdf.head()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\sse88\\anaconda3\\lib\\site-packages\\pyproj\\crs\\crs.py:141: FutureWarning:\n\n'+init=<authority>:<code>' syntax is deprecated. '<authority>:<code>' is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6\n\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>tag-local-identifier</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>30048</td>\n      <td>POINT (-47.53632 -4.43758)</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>30054</td>\n      <td>POINT (-62.47914 -5.03840)</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>30198</td>\n      <td>POINT (-57.46417 -2.77617)</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>30263</td>\n      <td>POINT (-50.19230 -5.70504)</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>30275</td>\n      <td>POINT (-57.70404 -16.72336)</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### 4) Where does each bird start and end its journey? (Part 2)\n\nUse the GeoDataFrames from the question above (`path_gdf`, `start_gdf`, and `end_gdf`) to visualize the paths of all birds on a single map.  You may also want to use the `americas` GeoDataFrame.\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nax = americas.plot(figsize = (8, 8), color = 'whitesmoke', linestyle = ':', edgecolor = 'black')\npath_gdf.plot(ax = ax, cmap = 'tab20b', linewidth = 1, linestyle = '-', zorder = 1)\nstart_gdf.plot(ax = ax, color = 'red', markersize = 10)\nend_gdf.plot(ax = ax, color = 'darkblue', markersize = 10)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n<AxesSubplot:>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](exercise2-coordinate-reference-systems_files/figure-html/cell-9-output-2.png){width=652 height=568}\n:::\n:::\n\n\n### 5) Where are the protected areas in South America? (Part 1)\n\nIt looks like all of the birds end up somewhere in South America.  But are they going to protected areas?\n\nIn the next code cell, you'll create a GeoDataFrame `protected_areas` containing the locations of all of the protected areas in South America.  The corresponding shapefile is located at filepath `protected_filepath`.\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\n# Path of the shapefile to load\nprotected_filepath = \"../../../spatial_analysis/data/SAPA_Aug2019-shapefile/SAPA_Aug2019-shapefile/SAPA_Aug2019-shapefile-polygons.shp\"\n\nprotected_areas = gpd.read_file(protected_filepath)\nprotected_areas.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>WDPAID</th>\n      <th>WDPA_PID</th>\n      <th>PA_DEF</th>\n      <th>NAME</th>\n      <th>ORIG_NAME</th>\n      <th>DESIG</th>\n      <th>DESIG_ENG</th>\n      <th>DESIG_TYPE</th>\n      <th>IUCN_CAT</th>\n      <th>INT_CRIT</th>\n      <th>...</th>\n      <th>GOV_TYPE</th>\n      <th>OWN_TYPE</th>\n      <th>MANG_AUTH</th>\n      <th>MANG_PLAN</th>\n      <th>VERIF</th>\n      <th>METADATAID</th>\n      <th>SUB_LOC</th>\n      <th>PARENT_ISO</th>\n      <th>ISO3</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>14067.0</td>\n      <td>14067</td>\n      <td>1</td>\n      <td>Het Spaans Lagoen</td>\n      <td>Het Spaans Lagoen</td>\n      <td>Ramsar Site, Wetland of International Importance</td>\n      <td>Ramsar Site, Wetland of International Importance</td>\n      <td>International</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>...</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>Management plan is not implemented and not ava...</td>\n      <td>State Verified</td>\n      <td>1856</td>\n      <td>Not Reported</td>\n      <td>NLD</td>\n      <td>ABW</td>\n      <td>POLYGON ((-69.97523 12.47379, -69.97523 12.473...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>14003.0</td>\n      <td>14003</td>\n      <td>1</td>\n      <td>Bubali Pond Bird Sanctuary</td>\n      <td>Bubali Pond Bird Sanctuary</td>\n      <td>Bird Sanctuary</td>\n      <td>Bird Sanctuary</td>\n      <td>National</td>\n      <td>Not Reported</td>\n      <td>Not Applicable</td>\n      <td>...</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>State Verified</td>\n      <td>1899</td>\n      <td>Not Reported</td>\n      <td>NLD</td>\n      <td>ABW</td>\n      <td>POLYGON ((-70.04734 12.56329, -70.04615 12.563...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>555624439.0</td>\n      <td>555624439</td>\n      <td>1</td>\n      <td>Arikok National Park</td>\n      <td>Arikok National Park</td>\n      <td>National Park</td>\n      <td>National Park</td>\n      <td>National</td>\n      <td>Not Reported</td>\n      <td>Not Applicable</td>\n      <td>...</td>\n      <td>Non-profit organisations</td>\n      <td>Non-profit organisations</td>\n      <td>Fundacion Parke Nacional Arikok</td>\n      <td>Not Reported</td>\n      <td>State Verified</td>\n      <td>1899</td>\n      <td>Not Reported</td>\n      <td>NLD</td>\n      <td>ABW</td>\n      <td>MULTIPOLYGON (((-69.96302 12.48384, -69.96295 ...</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>303894.0</td>\n      <td>303894</td>\n      <td>1</td>\n      <td>Madidi</td>\n      <td>Madidi</td>\n      <td>Area Natural de Manejo Integrado</td>\n      <td>Natural Integrated Management Area</td>\n      <td>National</td>\n      <td>Not Reported</td>\n      <td>Not Applicable</td>\n      <td>...</td>\n      <td>Federal or national ministry or agency</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>State Verified</td>\n      <td>1860</td>\n      <td>BO-L</td>\n      <td>BOL</td>\n      <td>BOL</td>\n      <td>POLYGON ((-68.59060 -14.43388, -68.59062 -14.4...</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>303893.0</td>\n      <td>303893</td>\n      <td>1</td>\n      <td>Apolobamba</td>\n      <td>Apolobamba</td>\n      <td>Area Natural de Manejo Integado Nacional</td>\n      <td>National Natural Integrated Management Area</td>\n      <td>National</td>\n      <td>Not Reported</td>\n      <td>Not Applicable</td>\n      <td>...</td>\n      <td>Federal or national ministry or agency</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>Not Reported</td>\n      <td>State Verified</td>\n      <td>1860</td>\n      <td>BO-L</td>\n      <td>BOL</td>\n      <td>BOL</td>\n      <td>POLYGON ((-69.20949 -14.73334, -69.20130 -14.7...</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 29 columns</p>\n</div>\n```\n:::\n:::\n\n\n### 6) Where are the protected areas in South America? (Part 2)\n\nCreate a plot that uses the `protected_areas` GeoDataFrame to show the locations of the protected areas in South America.  (_You'll notice that some protected areas are on land, while others are in marine waters._)\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n# Country boundaries in South America\nsouth_america = americas.loc[americas['continent'] == 'South America']\n\n# Plot protected areas in South America\nax = south_america.plot(figsize = (8, 8), color = 'white', edgecolor = 'gray')\nprotected_areas.plot(ax = ax, alpha = 0.4)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\n<AxesSubplot:>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](exercise2-coordinate-reference-systems_files/figure-html/cell-11-output-2.png){width=652 height=559}\n:::\n:::\n\n\n### 7) What percentage of South America is protected?\n\nYou're interested in determining what percentage of South America is protected, so that you know how much of South America is suitable for the birds.  \n\nAs a first step, you calculate the total area of all protected lands in South America (not including marine area).  To do this, you use the \"REP_AREA\" and \"REP_M_AREA\" columns, which contain the total area and total marine area, respectively, in square kilometers.\n\nRun the code cell below without changes.\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nP_Area = sum(protected_areas['REP_AREA']-protected_areas['REP_M_AREA'])\nprint(\"South America has {} square kilometers of protected areas.\".format(P_Area))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSouth America has 5396761.9116883585 square kilometers of protected areas.\n```\n:::\n:::\n\n\nThen, to finish the calculation, you'll use the `south_america` GeoDataFrame.  \n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\nsouth_america.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>pop_est</th>\n      <th>continent</th>\n      <th>name</th>\n      <th>iso_a3</th>\n      <th>gdp_md_est</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>9</th>\n      <td>44938712.0</td>\n      <td>South America</td>\n      <td>Argentina</td>\n      <td>ARG</td>\n      <td>445445</td>\n      <td>MULTIPOLYGON (((-68.63401 -52.63637, -68.25000...</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>18952038.0</td>\n      <td>South America</td>\n      <td>Chile</td>\n      <td>CHL</td>\n      <td>282318</td>\n      <td>MULTIPOLYGON (((-68.63401 -52.63637, -68.63335...</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>3398.0</td>\n      <td>South America</td>\n      <td>Falkland Is.</td>\n      <td>FLK</td>\n      <td>282</td>\n      <td>POLYGON ((-61.20000 -51.85000, -60.00000 -51.2...</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>3461734.0</td>\n      <td>South America</td>\n      <td>Uruguay</td>\n      <td>URY</td>\n      <td>56045</td>\n      <td>POLYGON ((-57.62513 -30.21629, -56.97603 -30.1...</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>211049527.0</td>\n      <td>South America</td>\n      <td>Brazil</td>\n      <td>BRA</td>\n      <td>1839758</td>\n      <td>POLYGON ((-53.37366 -33.76838, -53.65054 -33.2...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nCalculate the total area of South America by following these steps:\n- Calculate the area of each country using the `area` attribute of each polygon (with EPSG 3035 as the CRS), and add up the results.  The calculated area will be in units of square meters.\n- Convert your answer to have units of square kilometeters.\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\n# Calculate the total area of South America (in square kilometers)\ntotalArea = sum(south_america['geometry'].to_crs(epsg = 3035).area) / 10**6\ntotalArea\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```\n17759005.81506123\n```\n:::\n:::\n\n\nRun the code cell below to calculate the percentage of South America that is protected.\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\n# What percentage of South America is protected?\npercentage_protected = P_Area/totalArea\nprint('Approximately {}% of South America is protected.'.format(round(percentage_protected*100, 2)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nApproximately 30.39% of South America is protected.\n```\n:::\n:::\n\n\n### 8) Where are the birds in South America?\n\nSo, are the birds in protected areas?  \n\nCreate a plot that shows for all birds, all of the locations where they were discovered in South America.  Also plot the locations of all protected areas in South America.\n\nTo exclude protected areas that are purely marine areas (with no land component), you can use the \"MARINE\" column (and plot only the rows in `protected_areas[protected_areas['MARINE']!='2']`, instead of every row in the `protected_areas` GeoDataFrame).\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\nax = south_america.plot(figsize = (8, 8), color = 'white', edgecolor = 'gray')\nprotected_areas[protected_areas['MARINE'] != '2'].plot(ax = ax, alpha = 0.4, zorder = 1)\nbirds[birds['geometry'].y < 0].plot(ax = ax, color = 'red', alpha = 0.6, markersize = 10, zorder = 2)\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\n<AxesSubplot:>\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](exercise2-coordinate-reference-systems_files/figure-html/cell-16-output-2.png){width=652 height=565}\n:::\n:::\n\n\n# Keep going\n\nCreate stunning **[interactive maps](https://www.kaggle.com/alexisbcook/interactive-maps)** with your geospatial data.\n\n---\n\n*Have questions or comments? Visit the [course discussion forum](https://www.kaggle.com/learn/geospatial-analysis/discussion) to chat with other learners.*\n\n",
    "supporting": [
      "exercise2-coordinate-reference-systems_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}